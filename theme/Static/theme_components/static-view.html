<link rel="import" href="static-mainbar.html">
<link rel="import" href="static-background.html">
<link rel="import" href="static-titlebar.html">
<link rel="import" href="static-statusbar.html">
<link rel="import" href="static-view-list.html">

<polymer-element name="static-model" attributes="barText barTitle barLogo barTable backgroundImage titleText themeMode statusText">
  <script>
    Polymer('static-model', {
		  ready: function() {
			this.barText = this.barText || "model.barText";
			this.barTitle = this.barTitle || "model.barTitle";
			this.barLogo = this.barLogo || "model.barLogo";
			this.backgroundImage = this.backgroundImage || "model.backgroundImage";
			this.barTable = this.barTable || [];
			this.titleText = this.titleText || "model.titleText";
			this.themeMode = this.themeMode || "games";
			this.statusText = this.statusText || "model.statusText";
		  }
    });
  </script>
</polymer-element>

<polymer-element name="static-view-controller" attributes="modelMode modelObject viewTitle viewImage viewText viewStats viewBackgroundImage titleText">
  <script>
    Polymer('static-view-controller', {
		ready: function() {
			this.modelMode = this.modelMode || "games";
			this.modelObject = this.modelObject || null;
			
			this.updateDisplay();
		  },
		updateDisplay: function(){
			 try {
			  if(this.modelMode == "games"){
					this.viewTitle = this.modelObject.Name;
					this.viewImage = this.modelObject.Images.Boxarts.img_boxart_front[1] || "undefined";
					this.viewText = this.modelObject.Metadata.game_description || "undefined";
					this.viewBackgroundImage = this.modelObject.Images.Fanarts[Math.floor(Math.random() * this.modelObject.Images.Fanarts.length)][1];
					this.viewStats = [
						{
							"Platform": this.modelObject.PlatformId,
							"Release Date": this.modelObject.Metadata.game_releasedate,
							"Publisher": this.modelObject.Metadata.game_publisher,
							"Developer": this.modelObject.Metadata.game_developer
						},
						{
							"Last Played": "Never",
							"You've played": "0 hours"
						}
					];
				}
				if(this.modelMode == "platforms"){
						console.log(this.modelObject.Images.img_platform_productshot);
						this.viewTitle = this.modelObject.Name;
						this.viewStats = [
							{
								"Short Name": this.modelObject.Metadata.platform_shortname,
								"Company": this.modelObject.Metadata.platform_company,
								"Release Date": this.modelObject.Metadata.platform_releasedate
							}
						];
						this.viewImage = this.modelObject.Images.img_platform_productshot || "undefined";
				}
			}catch(event){
			
			}
		},
		modelObjectChanged: function(){
			this.updateDisplay(this.modelMode);
		}
		  
    });
  </script>
</polymer-element>


<polymer-element name="static-view">
	<template>

		<style>
			* /deep/ *::selection{
			  background: #dedede; /* WebKit/Blink Browsers */
			}
			:host{
				overflow: hidden;
				-webkit-user-select: none;
			}
			static-background{
				z-index: -10000;
				position: fixed;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
			}
			static-mainbar{
				max-height: 30%;
				height: 30%;
				width: 100%;
				display: table-row;
				bottom: 0;
				right: 0;
				left: 0;
			}
			static-titlebar{
				display: table-row;
				height: 75px;
				z-index: 1000;
				width: 100%;
				position: relative;
			}
			static-statusbar{
				display: table-row;
				height: 35px;
				z-index: 1000;
				position: relative;
			}
			static-view-list{
				display: table-row;
				height: auto;
				width: 100%
				
			}
			.container{
				display: table;
				height: 100%;
				width: 100%;
				left: 0;
				right: 0;
				top: 0;
				bottom: 0;
			}
			.hidden{
				height: 0;
				position: absolute; 
				visibility: hidden;
				display: none;
			}
		</style>
		
		<static-model id="model" 
			barText="{{barText}}" 
			barTitle="{{barTitle}}" 
			barLogo="{{barLogo}}" 
			backgroundImage="{{backgroundImage}}" 
			themeMode="{{themeMode}}" 
			statusText="{{statusText}}">
		</static-model>
		
		<static-view-controller 
			modelMode="{{themeMode}}" 
			modelObject="{{(themeMode == 'games') ? selectedGame : selectedPlatform}}"
			viewTitle="{{barTitle}}"
			viewText="{{barText}}" 
			viewStats="{{barTable}}"
			viewBackgroundImage="{{backgroundImage}}"
			titleText="{{titleText}}">
			</static-view-controller>
			
		<div class="container">
			<static-titlebar titleText="{{selectedPlatform.Name}}"></static-titlebar>
			<static-statusbar keyword="{{themeMode}}" status="{{statusText}}"></static-statusbar>
			<static-view-list displayModel="{{gamesModel}}" selectedModel="{{selectedGame}}" modelMode="games"></static-view-list>
			<static-view-list displayModel="{{platformsModel}}" selectedModel="{{selectedPlatform}}" modelMode="platforms"></static-view-list>
			<static-mainbar showPlay="{{(themeMode == 'games')}}" barText="{{barText}}" barTitle="{{barTitle}}" barLogo="{{selectedPlatform.Images.img_platform_logo}}" barTable="{{barTable}}"></static-mainbar>
		</div>
		
		<static-background backgroundImage="{{backgroundImage}}"><static-background>
</template>
	
	<script>
		Polymer('static-view', {
			ready: function() {
				this.statusText = "";
				this.themeMode = "platforms";
				this.gamesModel = snowflake.api.games;
				this.platformsModel = Object.keys(snowflake.api.platforms).map(function(k) { return snowflake.api.platforms[k] });
				this.barText = "someText";
				this.barTitle = "The Adventures of Jimmy Neutron, Boy Genius: Jimmy Neutron Vs. Jimmy Negatron"
				this.barLogo = "";
			}
			
		});
	</script>
</polymer-element>